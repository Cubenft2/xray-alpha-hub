project_id = "odncvfiuzliyohxrsigc"

[functions.zombiedog-agent]
verify_jwt = false

[functions.zombiedog-chat]
verify_jwt = false

[functions.populate-quotes-library]
verify_jwt = false

# Hourly job - offset to minute 30 to avoid collisions
[functions.manual-price-sync]
verify_jwt = false

[[functions.manual-price-sync.cron]]
schedule = "30 * * * *"

[functions.generate-brief-claude]
verify_jwt = false

[functions.generate-brief-morning]
verify_jwt = false

[[functions.generate-brief-morning.cron]]
schedule = "0 11 * * *"

[functions.generate-brief-evening]
verify_jwt = false

[[functions.generate-brief-evening.cron]]
schedule = "0 23 * * *"

[functions.generate-sunday-special]
verify_jwt = false

[[functions.generate-sunday-special.cron]]
schedule = "0 1 * * 1"

[functions.populate-token-addresses]
verify_jwt = false

# Every 15 min - offset to 5,20,35,50
[functions.exchange-data-aggregator]
verify_jwt = false

[[functions.exchange-data-aggregator.cron]]
schedule = "5,20,35,50 * * * *"

[functions.enhance-ticker-data]
verify_jwt = true

[functions.news-fetch]
verify_jwt = false

# Every 15 min - offset to 8,23,38,53 (keeps news + sentiment fresh)
[[functions.news-fetch.cron]]
schedule = "8,23,38,53 * * * *"

[functions.symbol-validation]
verify_jwt = false

[functions.coingecko-sync]
verify_jwt = true

# Every 6 hours - offset to minute 20
[functions.exchange-sync]
verify_jwt = false

[[functions.exchange-sync.cron]]
schedule = "20 */6 * * *"

[functions.symbol-intelligence]
verify_jwt = true

[functions.polygon-sync]
verify_jwt = true

[functions.quotes]
verify_jwt = false

[functions.sync-ticker-mappings]
verify_jwt = false

[functions.map-polygon-tickers]
verify_jwt = false

[functions.polygon-rest-poller]
verify_jwt = false

# Every 5 min - offset to 1,6,11,16...
[functions.polygon-stock-poller]
verify_jwt = false

[[functions.polygon-stock-poller.cron]]
schedule = "1-56/5 * * * *"

# Prefetch company details for all stocks (bulk mode, 500 per run)
# Every 4 hours - offset to minute 15
[functions.polygon-company-prefetch]
verify_jwt = false

[[functions.polygon-company-prefetch.cron]]
schedule = "15 */4 * * *"

# Daily at 2:15 AM UTC (staggered from 2:05)
[functions.auto-map-polygon-tickers]
verify_jwt = false

[[functions.auto-map-polygon-tickers.cron]]
schedule = "15 2 * * *"

# Auto-map exchange tickers to token_cards using exchange_pairs data
# Daily at 2:30 AM UTC (after exchange-sync at 2:20)
[functions.auto-map-exchange-tickers]
verify_jwt = false

[[functions.auto-map-exchange-tickers.cron]]
schedule = "30 2 * * *"

# Every 5 min - offset to 2,7,12,17...
[functions.price-poller]
verify_jwt = false

[[functions.price-poller.cron]]
schedule = "2-57/5 * * * *"

[functions.polygon-historical-data]
verify_jwt = false

[functions.polygon-technical-indicators]
verify_jwt = false

[functions.polygon-company-details]
verify_jwt = false

[functions.derivs]
verify_jwt = false

# LunarCrush functions - now read from token_cards DB (no API calls)
[functions.lunarcrush-social]
verify_jwt = false

# LunarCrush news - runs every 30 min (staggered to :12/:42 to avoid collisions)
[functions.lunarcrush-news]
verify_jwt = false

[[functions.lunarcrush-news.cron]]
schedule = "12,42 * * * *"

# LunarCrush universe - reads from token_cards (no API calls)
[functions.lunarcrush-universe]
verify_jwt = false

[functions.lunarcrush-coin-detail]
verify_jwt = false

[functions.backfill-crypto-history]
verify_jwt = true

[functions.coingecko-enrich]
verify_jwt = false

[functions.coingecko-logos]
verify_jwt = false

[functions.calculate-asset-sentiment]
verify_jwt = false

[functions.test-polygon-api]
verify_jwt = false

[functions.test-lunarcrush-api]
verify_jwt = false

[functions.generate-og-image]
verify_jwt = false

[functions.sync-stock-mappings]
verify_jwt = false

[functions.sync-crypto-mappings]
verify_jwt = false

[functions.coingecko-chart-data]
verify_jwt = false

[functions.polygon-crypto-prices]
verify_jwt = false

[functions.migrate-ticker-data]
verify_jwt = false

# Every 5 min - offset to 3,8,13,18...
[functions.polygon-stock-snapshot]
verify_jwt = false

[[functions.polygon-stock-snapshot.cron]]
schedule = "3-58/5 * * * *"

[functions.polygon-sparkline-data]
verify_jwt = false

[functions.fix-coingecko-mappings]
verify_jwt = false

[functions.asset-details]
verify_jwt = false

# Every 5 min - offset to 4,9,14,19...
[functions.warm-derivs-cache]
verify_jwt = false

[[functions.warm-derivs-cache.cron]]
schedule = "4-59/5 * * * *"

# Sync Polygon news to token_cards (FREE - unlimited)
# Every 15 min - offset to 10,25,40,55
[functions.sync-token-news-polygon]
verify_jwt = false

[[functions.sync-token-news-polygon.cron]]
schedule = "10,25,40,55 * * * *"

# Every 2 min - offset to odd minutes 1,3,5,7...
[functions.massive-crypto-snapshot]
verify_jwt = false

[[functions.massive-crypto-snapshot.cron]]
schedule = "1-59/2 * * * *"

# Daily at 3:25 AM UTC (staggered)
[functions.massive-forex-sync]
verify_jwt = false

[[functions.massive-forex-sync.cron]]
schedule = "25 3 * * *"

[functions.market-data]
verify_jwt = false

[functions.polygon-raw-preview]
verify_jwt = false

# Sync technical indicators to token_cards from Polygon OHLCV (local calculation)
# Every 3 min - offset to 1,4,7,10...
[functions.sync-polygon-crypto-technicals]
verify_jwt = false

[[functions.sync-polygon-crypto-technicals.cron]]
schedule = "1-58/3 * * * *"

# ============================================
# TOKEN CARDS SYNC FUNCTIONS - TIERED LUNARCRUSH
# ============================================

# Bootstrap token_cards from crypto_snapshot (run once manually)
[functions.bootstrap-token-cards]
verify_jwt = false

# TIER 1: Top 1000 tokens - every 10 min (144 calls/day)
[functions.sync-token-cards-lunarcrush-tier1]
verify_jwt = false

[[functions.sync-token-cards-lunarcrush-tier1.cron]]
schedule = "*/10 * * * *"

# TIER 2: Tokens 1001-2000 - every 30 min (staggered to :04/:34)
[functions.sync-token-cards-lunarcrush-tier2]
verify_jwt = false

[[functions.sync-token-cards-lunarcrush-tier2.cron]]
schedule = "4,34 * * * *"

# FULL SYNC: All 3000 tokens - every 2 hours (staggered to :59 to avoid minute-0 collisions)
[functions.sync-token-cards-lunarcrush]
verify_jwt = false

[[functions.sync-token-cards-lunarcrush.cron]]
schedule = "59 1,3,5,7,9,11,13,15,17,19,21,23 * * *"

# Sync token_cards prices from Polygon.io (every minute - no stagger needed)
[functions.sync-token-cards-polygon]
verify_jwt = false

[[functions.sync-token-cards-polygon.cron]]
schedule = "* * * * *"

# ============================================
# FOREX CARDS SYNC FUNCTIONS
# ============================================

# Bootstrap forex_cards from poly_fx_pairs (run once manually)
[functions.bootstrap-forex-cards]
verify_jwt = false

# Sync forex_cards prices from Polygon.io (every 15 min)
[functions.sync-forex-cards-polygon]
verify_jwt = false

[[functions.sync-forex-cards-polygon.cron]]
schedule = "5,20,35,50 * * * *"

# Sync forex_cards technicals from Polygon historical data
# Every 15 min - offset to 7,22,37,52
[functions.sync-forex-cards-technicals]
verify_jwt = false

[[functions.sync-forex-cards-technicals.cron]]
schedule = "7,22,37,52 * * * *"

# ENABLED: Tier 1 tokens only (~53 tokens) - AI summaries, posts, news, creators
# Budget: 48 runs/day × 8 calls/run = 384 LunarCrush API calls/day
# Each token refreshed ~2x/day (staggered to :18/:48 to avoid collisions)
[functions.sync-token-cards-lunarcrush-enhanced]
verify_jwt = false

[[functions.sync-token-cards-lunarcrush-enhanced.cron]]
schedule = "18,48 * * * *"

# Sync CoinGecko IDs and contract addresses to token_cards
# Daily at 2:05 AM UTC (staggered)
[functions.sync-token-cards-coingecko]
verify_jwt = false

[[functions.sync-token-cards-coingecko.cron]]
schedule = "5 2 * * *"

# Sync token metadata (descriptions, websites, socials) from CoinGecko
# Daily at 6:20 AM UTC (staggered)
[functions.sync-token-cards-metadata]
verify_jwt = false

[[functions.sync-token-cards-metadata.cron]]
schedule = "20 6 * * *"

# Dedicated Top 500 technicals sync (every 30 min, ensures ≤2 hour freshness)
[functions.sync-top500-technicals]
verify_jwt = false

[[functions.sync-top500-technicals.cron]]
schedule = "*/30 * * * *"

# Sync technical indicators for non-Polygon tokens via CoinGecko historical data
# Handles ranks 501+ (Top 500 handled by sync-top500-technicals)
# Runs 4x daily at minute 10 (5:10, 11:10, 17:10, 23:10 UTC)
[functions.sync-token-cards-coingecko-technicals]
verify_jwt = false

[[functions.sync-token-cards-coingecko-technicals.cron]]
schedule = "10 5,11,17,23 * * *"

# Sync CoinGecko prices, market cap, supply, ATH/ATL to dedicated columns
# Every 5 min - offset to 4,9,14,19...
[functions.sync-token-cards-coingecko-prices]
verify_jwt = false

[[functions.sync-token-cards-coingecko-prices.cron]]
schedule = "4-59/5 * * * *"

# Enrich contract addresses from CoinGecko cg_master.platforms (ZERO API cost - database only)
# Daily at 6:35 AM UTC (staggered from 6:20 metadata)
[functions.sync-token-cards-coingecko-contracts]
verify_jwt = false

[[functions.sync-token-cards-coingecko-contracts.cron]]
schedule = "35 6 * * *"

# ============================================
# STOCK CARDS SYNC FUNCTIONS
# ============================================

# Sync stock_cards from live_prices + company_details
# Every 10 min - offset to 1,11,21,31,41,51
[functions.sync-stock-cards]
verify_jwt = false

[[functions.sync-stock-cards.cron]]
schedule = "1,11,21,31,41,51 * * * *"

# Sync 52-week high/low for stocks
# Daily at 7:45 AM UTC (staggered after market data settles)
[functions.sync-stock-cards-52week]
verify_jwt = false

[[functions.sync-stock-cards-52week.cron]]
schedule = "45 7 * * *"

# Sync technical indicators for stocks
# Every 5 min - offset to 3,8,13,18...
[functions.sync-stock-cards-technicals]
verify_jwt = false

[[functions.sync-stock-cards-technicals.cron]]
schedule = "3-58/5 * * * *"

# Sync stock news from Polygon (FREE - unlimited)
# Every 15 min - offset to 12,27,42,57
[functions.sync-stock-news-polygon]
verify_jwt = false

[[functions.sync-stock-news-polygon.cron]]
schedule = "12,27,42,57 * * * *"

# ============================================
# WEBSOCKET SYNC FUNCTION
# ============================================

# Sync WebSocket prices from Cloudflare Worker to token_cards
# Every 30 seconds (runs at :00 and :30)
[functions.sync-token-cards-websocket]
verify_jwt = false

[[functions.sync-token-cards-websocket.cron]]
schedule = "*/1 * * * *"

# Mark tokens available in Polygon WebSocket stream
# Daily at 4:00 AM UTC
[functions.mark-polygon-tokens]
verify_jwt = false

[[functions.mark-polygon-tokens.cron]]
schedule = "0 4 * * *"

# ============================================
# LUNARCRUSH AI SYNC (Local generation - zero API cost)
# ============================================

# Generate AI summaries for all tokens with social data
# Runs every 2 hours, 5 min AFTER LunarCrush full sync completes
# This ensures summaries always use fresh LunarCrush data
# 12x daily - processes ~500 tokens/run = full coverage every ~4 runs
[functions.sync-token-cards-lunarcrush-ai]
verify_jwt = false

[[functions.sync-token-cards-lunarcrush-ai.cron]]
schedule = "5 */2 * * *"
